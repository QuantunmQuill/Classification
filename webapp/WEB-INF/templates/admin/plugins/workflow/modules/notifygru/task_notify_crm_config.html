
<div>
	<fieldset>
		<div class="control-group">
			<label class="control-label" for="id_resource_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_directory} * :</label>
			<div class="controls">
				<@comboWithParams name="id_resource_guichet" default_value=id_directory?string additionalParameters="class=\"input-xxlarge\"" items=list_id_resource_guichet />
			</div>
		</div>
		<#if list_id_demand_guichet?exists>
			<div class="control-group" id="id_demand_guichet">
				<label class="control-label" for="id_demand_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_id_demand} * :</label>
				<div class="controls">
					<@combo name="id_demand_guichet" items=list_id_demand_guichet default_value=id_demand_guichet />&nbsp;
					<span class="help-block">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_id_demand_comment}</span>
				</div>
			</div>
		</#if>
		<#if list_user_guid_guichet?exists && is_user_attribute_ws_active>
			<div class="control-group"id="user_guid_guichet">
				<label class="control-label" for="user_guid_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_user_guid} :</label>
				<div class="controls">
					<@combo name="user_guid_guichet" items=list_user_guid_guichet default_value=user_guid_guichet />&nbsp;
					<span class="help-block">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_user_guid_comment}</span>
				</div>
			</div>
		</#if>
		<#if list_crm_web_app_code_guichet?exists>
			<div class="control-group"id="crm_web_app_code_guichet">
				<label class="control-label" for="crm_web_app_code_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_crm_web_app_code}  :</label>
				<div class="controls">
						<@combo name="crm_web_app_code_guichet" items=list_crm_web_app_code_guichet default_value=crm_web_app_code_guichet />&nbsp;
						<span class="help-block">#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_entry_directory_crm_web_app_code_comment}</span>
				</div>
			</div>
		</#if>
		<div class="control-group">
			<label class="control-label" for="status_text_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_status_text} * :</label>
			<div class="controls">
				<input type="text" name="status_text_guichet" value="${status_text_guichet!}" size="80" maxlength="255" />
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="send_notification_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_send_notification} :</label>
			<div class="controls">
				<label class="checkbox">
					<input type="radio" name="send_notification_guichet" value="true" <#if send_notification_guichet>checked="checked"</#if> />
					&nbsp;#i18n{module.workflow.notifygru.task_notify_crm_config.label_send_notification.yes}
				</label>
				<label class="checkbox">
					<input type="radio" name="send_notification_guichet" value="false" <#if !send_notification_guichet>checked="checked"</#if> />
					&nbsp;#i18n{module.workflow.notifygru.task_notify_crm_config.label_send_notification.no}
				</label>
			</div>
		</div>
		<div class="control-group">
			<div class="controls">
				<button class="btn btn-small btn-primary" type="submit" name="apply" value="#i18n{module.workflow.notifygru.task_notify_crm_config.label_apply}">
					<i class="icon-ok icon-white">&nbsp;</i>&nbsp;#i18n{module.workflow.notifygru.task_notify_crm_config.label_apply}
				</button>
			</div>
		</div>
	</fieldset>
</div>
<#if send_notification_guichet>
	<div>
		<div class="control-group">
			<label class="control-label" for="sender_name_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_sender_name} * :</label>
			<div class="controls">
				<input type="text" name="sender_name_guichet" id="" size="80" value="${sender_name_guichet}" maxlength="255" />		
				#i18n{module.workflow.notifygru.task_notify_crm_config.label_sender_name_comment}
			</div>
		</div>
		<div class="control-group">
	    	<label class="control-label" for="subject_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_subject} * :</label>
			<div class="controls">
				<input type="text" name="subject_guichet" id="" size="80" value="${subject_guichet}" maxlength="255" />
				#i18n{module.workflow.notifygru.task_notify_crm_config.label_subject_comment}
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="message_guichet">#i18n{module.workflow.notifygru.task_notify_crm_config.label_message} * :</label>
			<div class="controls editor">
				<textarea name="message_guichet" id="" rows="20" cols="90" class="richtext">${message_guichet}</textarea>
				<span class="help-block">#i18n{module.workflow.notifygru.task_notify_crm_config.label_message_comment}</span>
			</div>
		</div>
		
		<#if config?exists && config.id_resource_guichet!=-1>
			<fieldset>
				<legend>#i18n{module.workflow.notifygru.task_notify_crm_config.label_directory_comment}</legend>
				<table class="table">
					<tr>
						<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_directory}</th>
						<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_freemarker}</th>
					</tr>
					<tr>
						<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_status}</td>
						<td>&#36;&#123;status&#125;</td>
					</tr>
					<tr>
						<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_directory_title}</td>
						<td>&#36;&#123;directory_title&#125;</td>
					</tr>
					<tr>
						<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_directory_description}</td>
						<td>&#36;&#123;directory_description&#125;</td>
					</tr>
				</table>
			</fieldset>
			<br />
			<#if is_user_attribute_ws_active>
				<fieldset class="user_attribute_freemarker">
					<legend>#i18n{module.workflow.notifygru.task_notify_crm_config.label_user_attribute_comment}</legend>
					<table class="table">
						<tr>
							<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_user_attribute}</th>
							<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_freemarker}</th>
						</tr>
						<tr>
							<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_first_name}</td>
							<td>&#36;&#123;first_name&#125;</td>
						</tr>
						<tr>
							<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_last_name}</td>
							<td>&#36;&#123;last_name&#125;</td>
						</tr>
						<tr>
							<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_email}</td>
							<td>&#36;&#123;email&#125;</td>
						</tr>
						<tr>
							<td>#i18n{module.workflow.notifygru.task_notify_crm_config.label_phone_number}</td>
							<td>&#36;&#123;phone_number&#125;</td>
						</tr>
					</table>
				</fieldset>
				<br />
			</#if>
			<#if tasks_list?exists && tasks_list?has_content>
				<fieldset>
					<legend>#i18n{module.workflow.notifygru.task_notify_crm_config.label_tasks_list_comment}</legend>
					<table class="table">
						<tr>
							<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_title}</th>
							<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_task_type}</th>
							<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_freemarker}</th>
						</tr>
						<#list tasks_list as task>
							<tr>
								<td>${task.getTitle( locale )!}</td>
								<td>${task.taskType.title!}</td>
								<td>&#36;&#123;task_${task.id!}&#125;</td>
							</tr>
						</#list>
					</table>
				</fieldset>
				<br />
			</#if>
			<fieldset>
				<legend>#i18n{module.workflow.notifygru.task_notify_crm_config.label_entry_directory_comment}</legend>
				<table class="table table-stripped">
			  		<tr>
			  			<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_entry}</th>
			  			<th>#i18n{module.workflow.notifygru.task_notify_crm_config.label_freemarker}</th>
			  		</tr>
				 	<#list list_entries_freemarker as entry>
					  	<tr>
					  		<td>
					  			${entry.title!}
					  		</td>
					  		<td>
					  			&#36;&#123;position_${entry.position}&#125;
					  		</td>
					  	</tr>
					  </#list>
				</table>
			</fieldset>
			<br />
		</#if>
	  	
	</div>
</#if>
<script type="text/javascript">
	$( document ).ready( function(  ) {
		if ( $( '#entry_user_guid select' ).val(  ) == "-1" ) {
			$( '.user_attribute_freemarker' ).hide(  );
		};
		$( '#entry_user_guid select' ).change( function(  ) {
			$( '.user_attribute_freemarker' ).toggle( $( this ).val(  ) != '-1' );
		} );
	} );
</script>
<@initEditor />